<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>সেবা কর্মি</title>
  <style>
    body {font-family: Arial, sans-serif; background:#f5f5f5; margin:0; padding:0;}
    header {background:#4CAF50; color:white; padding:15px; text-align:center;}
    .donate-btn {background:#ff5722; color:white; padding:10px 20px; border:none; border-radius:5px; cursor:pointer;}
    .slider-container {width:100%; overflow:hidden; margin-bottom:20px;}
    .slider {display:flex; animation:slide 12s infinite;}
    .slider img {width:100%; flex-shrink:0; border-radius:10px;}
    @keyframes slide {
      0% {transform:translateX(0);}
      33% {transform:translateX(-100%);}
      66% {transform:translateX(-200%);}
      100% {transform:translateX(0);}
    }
    .filters {padding:15px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap; background:#fff;}
    .filters input, .filters select {padding:8px; border:1px solid #ccc; border-radius:5px;}
    .posts {display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:15px; padding:15px;}
    .card {background:white; border-radius:10px; padding:10px; box-shadow:0 2px 5px rgba(0,0,0,0.2);}
    .card img {width:100%; height:150px; object-fit:cover; border-radius:10px;}
    .card h3 {margin:5px 0;}
    .order-btn {background:#4CAF50; color:white; padding:8px 12px; border:none; border-radius:5px; cursor:pointer;}
    .locked {opacity:0.5; pointer-events:none;}
    .modal {display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); justify-content:center; align-items:center;}
    .modal-content {background:white; padding:20px; border-radius:10px; width:90%; max-width:700px;}
    .modal-content input, textarea, select {width:100%; margin-bottom:10px; padding:8px; border:1px solid #ccc; border-radius:5px;}
    .close {float:right; cursor:pointer; color:red;}
    #loadMoreBtn {display:block; margin:20px auto; background:#007bff; color:white; border:none; padding:10px 20px; border-radius:5px; cursor:pointer;}
  </style>
</head>
<body>
  <header>
    <h1> সেবা কর্মি নিয়োগ </h1>
  </header>

  <!-- Slider -->
  <div class="slider-container">
    <div class="slider">
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQw9SaJOLWdcO9itq3FOR_1KWL_T5oVk1FDEdT5CsfRLikmiFpm" alt="Slide 1">
      <img src="https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcRz_baD2gyYoN3Rjwfy-ti_Vj8g5gJSNLPo2TsKAjwGxeUuHuk0" alt="Slide 2">
      <img src="https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcQgn5PlleCNBlHQQXMToUAxisaZ2Zd3SBVN-FUj0zbDaO-cerAZ" alt="Slide 3">
    </div>
  </div>

  <div style="text-align:center;">
    
  </div>

  <div class="filters">
    <input type="text" id="searchBox" placeholder="নাম দিয়ে খুঁজুন..." onkeyup="filterPosts()">
    <select id="areaFilter" onchange="filterPosts()">
      <option value="">কেটাগরি নির্বাচন </option>
    </select>
    <select id="catFilter" onchange="filterPosts()">
      <option value="">পদবি নির্বাচন </option>
    </select>
  </div>

  <div id="posts" class="posts"></div>
  <button id="loadMoreBtn" onclick="loadMore()">আরও দেখুন</button>

  <!-- Donate Modal -->
  <div id="donateModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeDonateForm()">✖</span>
      <h3>বস্ত্রদান ফর্ম</h3>
      <input type="text" id="dPname" placeholder="পণ্যের নাম">
      <select id="dAddress">
        <option value="">এরিয়া নির্বাচন</option>
        <option>চট্টগ্রাম</option>
       
      </select>
      <input type="text" id="dWhatsapp" placeholder="WhatsApp নাম্বার">
      <select id="dCategory">
        <option value="">পণ্য ক্যাটাগরি</option>
        <option>পুরুষ সামগ্রী</option>
       
        <option>অন্যান্য</option>
      </select>
      <input type="text" id="dCode" placeholder="পণ্যের কোড (ইউনিক)">
      <textarea id="dDescription" placeholder="বর্ণনা"></textarea>
      <input type="text" id="dImage" placeholder="প্রোফাইল লিংক দিন">
      <button onclick="submitDonate()">সাবমিট</button>
    </div>
  </div>

  <!-- Order Modal -->
  <div id="orderModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeOrderForm()">বন্ধ করুন</span>
      <h3>আবেদন ফর্ম</h3>
      <input type="hidden" id="orderItemCode">
      <input type="hidden" id="orderWhatsapp">
      <input type="text" id="oName" placeholder="আপনার নাম">
      <input type="text" id="oAddress" placeholder="আপনার ঠিকানা">
      <input type="text" id="oPhone" placeholder="আপনার ফোন">
      <textarea id="oDescription" placeholder="আবেদন পত্র"></textarea>
      <button onclick="submitOrder()">সাবমিট</button>
    </div>
  </div>

  <script>
    const sheetURL = "https://opensheet.elk.sh/1FUCNLl0RC4li5-3wrw2zP3ZR-2FPE8QiuFu9cRobl0o/Sheet1";
    const orderScriptURL = "https://script.google.com/macros/s/AKfycbzHPujfqh_ajkmuWlzpTJdQ3b8G6GypOyCOl2KVf_5iSewXo4K-Trk4oSJIjMtMDWB9/exec";

    let data = [];
    let visibleCount = 0;
    const batchSize = 20;

    fetch(sheetURL)
      .then(res => res.json())
      .then(json => {
        data = json;
        loadMore();
        populateFilters();
      });

    function loadMore() {
      const container = document.getElementById("posts");
      const slice = data.slice(visibleCount, visibleCount + batchSize);
      slice.forEach(item => {
        if (!item.Locked || item.Locked !== "yes") {
          const card = document.createElement("div");
          card.className = "card";
          card.dataset.area = item.Address;
          card.dataset.cat = item.Category;
          card.innerHTML = `
            <h3>${item.Pname}</h3>
            <p>কেটাগরি: ${item.Address}<br>পদবি: ${item.Category}</p>
            <button onclick="toggleDesc(this)" style="background:#555; padding:5px 10px; font-size:13px; color:white;"> বিস্তারিত</button>
            <p class="desc" style="display:none; margin-top:10px;">${item.Description || ""}</p>
            <button class="order-btn" onclick='openOrderForm(${JSON.stringify(item)})'>আবেদন</button>`;
          container.appendChild(card);
        }
      });
      visibleCount += batchSize;
      if (visibleCount >= data.length) document.getElementById("loadMoreBtn").style.display = "none";
    }

    function populateFilters() {
      const areaSelect = document.getElementById("areaFilter");
      const catSelect = document.getElementById("catFilter");
      const areas = new Set(), cats = new Set();
      data.forEach(item => {
        if (item.Address) areas.add(item.Address);
        if (item.Category) cats.add(item.Category);
      });
      areas.forEach(a => areaSelect.innerHTML += `<option>${a}</option>`);
      cats.forEach(c => catSelect.innerHTML += `<option>${c}</option>`);
    }

    function filterPosts() {
      let search = document.getElementById("searchBox").value.toLowerCase();
      let area = document.getElementById("areaFilter").value;
      let cat = document.getElementById("catFilter").value;
      document.querySelectorAll(".card").forEach(card => {
        let match = true;
        if (search && !card.innerText.toLowerCase().includes(search)) match = false;
        if (area && card.dataset.area !== area) match = false;
        if (cat && card.dataset.cat !== cat) match = false;
        card.style.display = match ? "block" : "none";
      });
    }

    function openDonateForm() { document.getElementById("donateModal").style.display = "flex"; }
    function closeDonateForm() { document.getElementById("donateModal").style.display = "none"; }
    function openOrderForm(item) {
      document.getElementById("orderModal").style.display = "flex";
      orderItemCode.value = item.Code;
      orderWhatsapp.value = item.Whatsapp;
    }
    function closeOrderForm() { document.getElementById("orderModal").style.display = "none"; }

    function submitDonate() {
      const d = {
        Pname: dPname.value,
        Address: dAddress.value,
        Whatsapp: dWhatsapp.value,
        Category: dCategory.value,
        Code: dCode.value,
        Description: dDescription.value,
        Image: dImage.value
      };
      fetch(orderScriptURL, { method: "POST", body: JSON.stringify(d) })
        .then(() => { alert(" application successfully submitted"); closeDonateForm(); });
    }

    function submitOrder() {
      const orderData = {
        Name: oName.value,
        Address: oAddress.value,
        Phone: oPhone.value,
        Code: orderItemCode.value,
        Whatsapp: orderWhatsapp.value,
        Description: oDescription.value,
        Action: "order"
      };
      fetch(orderScriptURL, {
        method: "POST",
        body: JSON.stringify(orderData)
      })
        .then(() => {
          alert(" application successfully submitted");
          closeOrderForm();
        });
    }

    function toggleDesc(btn) {
      const desc = btn.nextElementSibling;
      desc.style.display = desc.style.display === "none" ? "block" : "none";
      btn.textContent = desc.style.display === "none" ? "Show" : "Hide";
    }
  </script>
</body>
</html>
