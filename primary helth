<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>প্রাথমিক চিকিতসা</title>
  <style>
    body {font-family: Arial, sans-serif; background:#f5f5f5; margin:0; padding:0;}
    header {background:#4CAF50; color:white; padding:15px; text-align:center;}
    .donate-btn {background:#ff5722; color:white; padding:10px 20px; border:none; border-radius:5px; cursor:pointer;}
    
    .slider-container {width:100%; overflow:hidden; margin-bottom:20px;}
    .slider {display:flex; animation:slide 12s infinite;}
    .slider img {width:100%; flex-shrink:0; border-radius:10px;}
    @keyframes slide {
      0% {transform:translateX(0);}
      33% {transform:translateX(-100%);}
      66% {transform:translateX(-200%);}
      100% {transform:translateX(0);}
    }

    .filters {padding:15px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap; background:#fff;}
    .filters input, .filters select {padding:8px; border:1px solid #ccc; border-radius:5px;}
    .posts {display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:15px; padding:15px;}
    .card {background:white; border-radius:10px; padding:10px; box-shadow:0 2px 5px rgba(0,0,0,0.2);}
    .card img {width:100%; height:150px; object-fit:cover; border-radius:10px;}
    .card h3 {margin:5px 0;}
    .profile-btn {background:#007bff; color:white; padding:8px 12px; border:none; border-radius:5px; cursor:pointer;}
    .desc {margin-top:10px; color:#333; line-height:1.4;}
    #loadMoreBtn {display:block; margin:20px auto; background:#007bff; color:white; border:none; padding:10px 20px; border-radius:5px; cursor:pointer;}

    /* Modal */
    .modal {display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); justify-content:center; align-items:center;}
    .modal-content {background:white; padding:20px; border-radius:10px; width:90%; max-width:700px;}
    .modal-content input, textarea, select {width:100%; margin-bottom:10px; padding:8px; border:1px solid #ccc; border-radius:5px;}
    .close {float:right; cursor:pointer; color:red;}
  </style>
</head>
<body>
  <header>
    <h1>প্রাথমিক চিকিতসা</h1>
    <div style="text-align: center; margin-top: 50px;">
      <details>
        <summary style="cursor: pointer; padding: 8px 12px; background:#007bff; color:#fff; border-radius:6px; display:inline-block;">
          প্রাথমিক সম্পর্কে
        </summary>
        <p style="margin:10px 0 0 0;">
          আমাদের সমাজে এমন অসংখ্য মানুষ আছে, ।</b>
        </p>
      </details>
    </div>
  </header>
  
  <!-- Slider -->
  <div class="slider-container">
    <div class="slider">
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQLORKEp7isDA3P7xh36o-CKsKilF9W6NEhUg&s" alt="Slide 1">
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRaykHa8P6yOE2nJoGN1jg694Ti9J1apcN42g&s" alt="Slide 2">
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQS6b-jeOqN8Z3HuvwgAIgMp7SDu3eR4L8U6Q&s" alt="Slide 3">
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRAUZ1Q1DP6z7lNPpI0O_ry-9W8JVG2toT5Iw&s" alt="Slide 4">
    </div>
  </div>
  
  <!-- Donation button -->
  <header>
    
  </header>

  <!-- Filters -->
  <div class="filters">
    <input type="text" id="searchBox" placeholder="নাম দিয়ে খুঁজুন..." onkeyup="filterPosts()">
    <select id="areaFilter" onchange="filterPosts()">
      <option value="">লেভেল নির্বাচন করুন</option>
    </select>
    <select id="catFilter" onchange="filterPosts()">
      <option value="">ক্যাটাগরি নির্বাচন করুন</option>
    </select>
  </div>

  <!-- Posts -->
  <div id="posts" class="posts"></div>
  <button id="loadMoreBtn" onclick="loadMore()">আরও দেখুন</button>

  <!-- Donate Form Modal -->
  
  <script>
    const sheetURL="https://opensheet.elk.sh/1ieBa-5w-TRVCFNXIcM4iA7EPjUsQawr7Tqk8mBYzCQ0/Sheet1"; 
    let data=[];
    let visibleCount=0;
    const batchSize=20;

    // Load Data
    fetch(sheetURL)
    .then(res=>res.json())
    .then(json=>{
      data=json;
      loadMore();
      populateFilters();
    });

    function loadMore(){
      const container=document.getElementById("posts");
      const slice=data.slice(visibleCount, visibleCount+batchSize);
      slice.forEach(item=>{
        const card=document.createElement("div");
        card.className="card";
        card.dataset.area=item.Address;
        card.dataset.cat=item.Category;
        card.dataset.code=item.Code;

        const shortDesc=item.Description?.length>80 ? item.Description.substring(0,80)+"..." : item.Description;

        card.innerHTML=`
          <h3>${item.Pname}</h3>
          <p>লেভেল: ${item.Address}<br>ক্যাটাগরি: ${item.Category}</p>
          <p class="desc" id="desc-${item.Code}">${shortDesc}</p>
          ${item.Description?.length>80 ? `<button onclick="toggleMore('${item.Code}','${encodeURIComponent(item.Description)}')" style="background:#555; color:white; border:none; border-radius:4px; padding:5px 10px;">More</button>` : ""}
          `;
        container.appendChild(card);
      });
      visibleCount+=batchSize;
      if(visibleCount>=data.length) document.getElementById("loadMoreBtn").style.display="none";
    }

    function toggleMore(code,fullText){
      const desc=document.getElementById("desc-"+code);
      if(desc.dataset.expanded==="true"){
        desc.textContent=fullText.substring(0,80)+"...";
        desc.dataset.expanded="false";
        event.target.textContent="More";
      }else{
        desc.textContent=decodeURIComponent(fullText);
        desc.dataset.expanded="true";
        event.target.textContent="Few";
      }
    }

    function populateFilters(){
      const areaSelect=document.getElementById("areaFilter");
      const catSelect=document.getElementById("catFilter");
      const areas=new Set(), cats=new Set();
      data.forEach(item=>{if(item.Address) areas.add(item.Address); if(item.Category) cats.add(item.Category);});
      areas.forEach(a=>areaSelect.innerHTML+=`<option>${a}</option>`);
      cats.forEach(c=>catSelect.innerHTML+=`<option>${c}</option>`);
    }

    function filterPosts(){
      let search=document.getElementById("searchBox").value.toLowerCase();
      let area=document.getElementById("areaFilter").value;
      let cat=document.getElementById("catFilter").value;
      document.querySelectorAll(".card").forEach(card=>{
        let match=true;
        if(search && !card.innerText.toLowerCase().includes(search)) match=false;
        if(area && card.dataset.area!==area) match=false;
        if(cat && card.dataset.cat!==cat) match=false;
        card.style.display=match?"block":"none";
      });
    }

    // Donate Form
    function openDonateForm(){document.getElementById("donateModal").style.display="flex";}
    function closeDonateForm(){document.getElementById("donateModal").style.display="none";}
    function submitDonate(){
      const d={Pname:dPname.value,Address:dAddress.value,Whatsapp:dWhatsapp.value,Category:dCategory.value,Code:dCode.value,Description:dDescription.value,Image:dImage.value};
      fetch("https://script.google.com",{method:"POST",body:JSON.stringify(d)})
      .then(()=>{alert("✅ সফলভাবে সংরক্ষণ হয়েছে");closeDonateForm();});
    }
  </script>
</body>
</html>
